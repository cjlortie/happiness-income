---
title:
author: 
date: 
output:
  html_document:
    theme: yeti
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
---
#An exploration of happiness by income.  
<br>

![](./mr-robot.jpg)

###Data
```{r, data, warning=FALSE, message=FALSE}
library(foreign)
data = read.spss("data/Data540.sav", to.data.frame=TRUE)
#data


library(tidyverse)
data <- read_csv("data/happiness.csv")
#data
likert.data <- data %>% mutate(HAPPY = case_when(.$HAPPY == "Very unhappy" ~ 1, .$HAPPY == "Unhappy" ~ 2, .$HAPPY == "Mixed" ~ 3, .$HAPPY == "Happy" ~ 4, .$HAPPY == "Very happy" ~ 5))

```

###Viz
```{r, viz, warning=FALSE, message=FALSE}
ggplot(data, aes(INC1, fill = HAPPY)) +
  geom_bar() +
  facet_grid(~GENDER1) +
  labs(x = "primary income", y = "frequency", fill = "reported happiness")

ggplot(likert.data, aes(HAPPY, fill = GENDER1)) +
  geom_bar() + 
  scale_fill_brewer(palette = "Greens") +
  labs(x = "reported happiness (Likert scores)", y = "frequency", fill = "")
  

ggplot(likert.data, aes(INC1, HAPPY, color = GENDER1)) +
  geom_point() +
  geom_smooth(method = lm) +
  labs(x = "primary income", y = "Likert Scores", color = "") + 
  scale_color_brewer(palette = "Greens")


```

###Models
```{r, models, warning=FALSE, message=FALSE}
m <- wilcox.test(HAPPY ~ GENDER1, data = likert.data)
m

c <- cor.test(likert.data$HAPPY, likert.data$INC1, method = "kendall")

likert.m <- likert.data %>% filter(GENDER1 == "Male")
likert.f <- likert.data %>% filter(GENDER1 == "Female")

cor.test(likert.m$HAPPY, likert.m$INC1, method = "kendall")
cor.test(likert.f$HAPPY, likert.f$INC1, method = "kendall")

require(MASS)
m <- polr(as.factor(HAPPY) ~ INC1*GENDER1, Hess=TRUE, data = data)
m


```